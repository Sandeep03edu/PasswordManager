const express = require("express");
const {
  getCardDetails,
  addUpdateCard,
  getAllCards,
  deleteCardById,
  securePaginatedAllCards,
} = require("../controller/credentailCardController");
const { protectUser } = require("../middleware/protectUser");
const {
  addUpdatePassword,
  getAllPasswords,
  getPasswordDetails,
  deletePasswordById,
  securePaginatedAllPasswords,
} = require("../controller/credentialPasswordController");
const {
  fetchRecentEncryptedCredentials,
  fetchMonthlyCredentialsData,
  fetchCredentialCount,
} = require("../controller/CredentialController");

const router = express.Router();

router.post("/addUpdateCard", protectUser, addUpdateCard);

router.post("/addUpdatePassword", protectUser, addUpdatePassword);

router.post("/fetchAllCards", protectUser, getAllCards);

router.post("/fetchAllPasswords", protectUser, getAllPasswords);

router.post("/fetchCardDetails", protectUser, getCardDetails);

router.post("/fetchPasswordDetails", protectUser, getPasswordDetails);

router.get(
  "/fetchRecentEncryptedCredentials",
  protectUser,
  fetchRecentEncryptedCredentials
);

router.get(
  "/fetchMonthlyCredentialsData",
  protectUser,
  fetchMonthlyCredentialsData
);

router.get(
  "/securePaginatedAllPasswords",
  protectUser,
  securePaginatedAllPasswords
);

router.get("/securePaginatedAllCards", protectUser, securePaginatedAllCards);

router.get("/fetchCredentialCount", protectUser, fetchCredentialCount);

router.delete("/deleteCardById", protectUser, deleteCardById);

router.delete("/deletePasswordById", protectUser, deletePasswordById);

module.exports = router;
